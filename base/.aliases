#shellcheck shell=bash
if [ "$DEBUG" = "true" ]; then echo "$DOTFILESLOC/base/.aliases" ; fi

# System limits
ulimit -c 10000000

# =============================================================================
# SYSTEM & SERVICE MANAGEMENT
# =============================================================================

# System UI management (Linux systemd)
alias ui-text='sudo systemctl set-default multi-user.target'
alias ui-graphical='sudo systemctl set-default graphical.target'
alias ui-start='sudo systemctl start display-manager.service'

# Package management cleanup (Debian/Ubuntu)
alias apt-clean='sudo apt-get update && sudo apt-get autoclean && sudo apt-get clean && sudo apt-get autoremove'

# Dotfiles management
alias bootstrap="$HOME/.dotfiles/setup/bootstrap.sh"

# Auto-sudo for common commands (if not root)
if [[ $UID != 0 ]] ; then
    alias yum='sudo yum'
    alias apt='sudo apt'
    alias service='sudo service'
    alias chkconfig='sudo chkconfig'
fi

# =============================================================================
# FILE SYSTEM & DIRECTORY NAVIGATION  
# =============================================================================

# Directory navigation
cd() { builtin cd "$@" || return; ll; }    # cd:       Change directory and list contents
alias cd.='cd `pwd -LP`'                   # cd.:      Go to symlink's actual directory
alias cd..='cd ../'                        # cd..:     Go back 1 directory level (typo helper)
alias ..='cd ../'                          # ..:       Go back 1 directory level
alias ...='cd ../../'                      # ...:      Go back 2 directory levels
alias .3='cd ../../../'                    # .3:       Go back 3 directory levels
alias .4='cd ../../../../'                 # .4:       Go back 4 directory levels
alias .5='cd ../../../../../'              # .5:       Go back 5 directory levels
alias .6='cd ../../../../../../'           # .6:       Go back 6 directory levels
alias ~="cd ~"                             # ~:        Go to home directory

# File listing (base versions - platforms may override for OS-specific flags)
alias ls='ls -haF --color=auto'            # ls:       List with hidden files, colors, indicators
alias ll='ls -al'                          # ll:       Detailed list with hidden files
alias l.='ls -d .*'                        # l.:       List only hidden files
alias ll.='l. -al'                         # ll.:      Detailed list of hidden files
alias lr='ls -R | grep ":$" | sed -e '\''s/:$//'\'' -e '\''s/[^-][^\/]*\//--/g'\'' -e '\''s/^/   /'\'' -e '\''s/-/|/'\'' | less'

# File operations
alias mkdir='mkdir -pv'                    # mkdir:    Create directories with parents and verbose
alias cp='cp -iv'                          # cp:       Copy with interactive and verbose
alias rm='rm -iv'                          # rm:       Remove with interactive and verbose
alias del='rm -iv'                         # del:      Alternative for rm
alias rclone='rclone --progress'           # rclone:   Show progress for rclone operations

# Disk usage
alias df='sudo df -h'                      # df:       Show disk usage in human readable format
alias du='sudo du -h'                     # du:       Show directory usage in human readable format
alias du1='sudo du -h --max-depth=1 | sort -h'  # du1: Show directory usage 1 level deep, sorted

# Permission fixing
alias fix-perms='sudo find ./ -type f -exec chmod 0664 {} \; && sudo find ./ -type d -exec chmod 0775 {} \;'

# =============================================================================
# EDITORS & FILE VIEWING
# =============================================================================

# Editor shortcuts
alias v='vim -R -'                         # v:        Read-only vim from stdin
alias vi='vim'                             # vi:       Use vim for vi command
alias l='less'                             # l:        Use less for paging
alias less='less -FSRXc'                   # less:     Better less defaults

# View latest files
alias taill='tail -f $(ls -Art | tail -n 1)'  # taill:   Follow tail on most recent file
alias vil='vi $(ls -Art | tail -n 1)'         # vil:     Edit most recent file

# =============================================================================
# SEARCH & GREP
# =============================================================================

# Grep with colors
alias grep='grep --color=tty'              # grep:     Grep with colors
alias egrep='egrep --color=tty'            # egrep:    Extended grep with colors

# File searching
alias qfind="find . -name "                # qfind:    Quick find by name
ff () { /usr/bin/find . -name "$*" ; }     # ff:       Find file under current directory
ffs () { /usr/bin/find . -name "$*" ; }    # ffs:      Find file whose name starts with string
ffe () { /usr/bin/find . -name "*$*" ; }   # ffe:      Find file whose name ends with string

# =============================================================================
# COMMAND HISTORY & SYSTEM INFO
# =============================================================================

# History searching
alias hg='history | grep '                 # hg:       Search command history

# System information
alias c='clear'                            # c:        Clear terminal display
alias which='type -all'                    # which:    Find executables (base - platforms may override)
alias path='echo -e ${PATH//:/\\n}'        # path:     Show all executable paths
alias show_options='shopt'                 # show_options: Display bash options settings
alias fix_stty='stty sane'                 # fix_stty: Restore terminal settings when messed up
alias cic='set completion-ignore-case On'  # cic:      Make tab-completion case-insensitive
alias su-='su -'                           # su-:      Switch user with login shell

# =============================================================================
# PROCESS MANAGEMENT
# =============================================================================

# Process listing
alias psa='ps axf'                         # psa:      Show all processes in tree format
alias psA='ps -Af'                         # psA:      Show all processes with full format

# Process monitoring
alias memHogsTop='top -l 1 -o rsize | head -20'       # memHogsTop:  Find memory hogs with top
alias memHogsPs='ps wwaxm -o pid,stat,vsize,rss,time,command | head -10'  # memHogsPs: Find memory hogs with ps
alias cpu_hogs='ps wwaxr -o pid,stat,%cpu,time,command | head -10'        # cpu_hogs:  Find CPU hogs
alias topForever='top -l 9999999 -s 10 -o cpu'       # topForever:  Continuous top listing
alias ttop="top -R -F -s 10 -o rsize"                 # ttop:        Optimized top invocation

# Process functions
findPid () { lsof -t -c "$@" ; }           # findPid:  Find PID of process (supports regex)
my_ps() { ps "$@" -u "$USER" -o pid,%cpu,%mem,start,time,bsdtime,command ; }  # my_ps: Show my processes

# =============================================================================
# FILE MANAGEMENT UTILITIES
# =============================================================================

# File creation
alias numFiles='echo $(ls -1 | wc -l)'     # numFiles: Count non-hidden files in current dir
alias make1mb='mkfile 1m ./1MB.dat'        # make1mb:  Create 1MB file (macOS - Linux will override)
alias make5mb='mkfile 5m ./5MB.dat'        # make5mb:  Create 5MB file (macOS - Linux will override)
alias make10mb='mkfile 10m ./10MB.dat'     # make10mb: Create 10MB file (macOS - Linux will override)

# Archive functions
zipf () { zip -r "$1".zip "$1" ; }         # zipf:     Create ZIP archive of folder

# =============================================================================
# NETWORKING
# =============================================================================

# Network information
alias myip='dig +short myip.opendns.com @resolver1.opendns.com'  # myip:    Get public IP address
alias netCons='lsof -i'                    # netCons:  Show all open TCP/IP sockets
alias lsock='sudo /usr/sbin/lsof -i -P'    # lsock:    Display open sockets
alias lsockU='sudo lsof -nP | grep UDP'    # lsockU:   Display only open UDP sockets
alias lsockT='sudo lsof -nP | grep TCP'    # lsockT:   Display only open TCP sockets
alias openPorts='sudo lsof -i | grep LISTEN'  # openPorts: All listening connections

# DNS & Network (base versions - platforms may override)
alias flushDNS='dscacheutil -flushcache'   # flushDNS: Flush DNS cache (macOS - Linux will override)
alias ipInfo0='ipconfig getpacket en0'     # ipInfo0:  Get connection info for en0 (macOS)
alias ipInfo1='ipconfig getpacket en1'     # ipInfo1:  Get connection info for en1 (macOS)
alias showBlocked='sudo ipfw list'         # showBlocked: Show firewall rules (macOS)

# Network information function
ii() {
    echo -e "\nYou are logged on ${RED}$HOST"
    echo -e "\nAdditional information:$NC " ; uname -a
    echo -e "\n${RED}Users logged on:$NC " ; w -h
    echo -e "\n${RED}Current date:$NC " ; date
    echo -e "\n${RED}Machine stats:$NC " ; uptime
    echo -e "\n${RED}Current network location:$NC " ; scselect 2>/dev/null || echo "N/A"
    echo -e "\n${RED}Public facing IP Address:$NC " ; myip
    echo
}

# =============================================================================
# PLATFORM OVERRIDES
# =============================================================================
# Note: Platform-specific aliases will override these base definitions
# This allows for OS-specific command variations (e.g., ls flags, which command)

# These should be the last 2 lines of the file
# Don't make edits below this
# shellcheck source=/dev/null
[[ -f "$DOTFILESLOC/platforms/${OS}/.aliases" ]] && source "$DOTFILESLOC/platforms/${OS}/.aliases"
# shellcheck source=/dev/null
[[ -f ~/.aliases.local ]] && source ~/.aliases.local